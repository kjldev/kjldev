---
import Footer from '../components/Footer';
import Header from '../components/Header.astro';
import Separator from '../components/Separator.astro';
import AppInsightsInit from '../components/AppInsightsInit.tsx';

import '../styles/global.css';

interface Props {
	title?: string;
}

const defaultTitle = 'KJL Solutions Ltd.';
---

<!doctype html>
<html lang='en'>
	<head>
		<meta charset='UTF-8' />
		<meta
			name='viewport'
			content='width=device-width, initial-scale=1.0'
		/>
		<meta
			name='description'
			content='KJL Solutions Ltd. offers digital delivery consultancy services to accelerate your projects and teams.'
		/>
		<meta
			property='og:title'
			content={Astro.props.title ?? defaultTitle}
		/>
		<meta
			property='og:description'
			content='Accelerating projects with expert digital delivery consultancy.'
		/>
		<link
			rel='icon'
			type='image/svg+xml'
			href='/favicon.svg'
		/>
		<title>{Astro.props.title ?? defaultTitle}</title>

		<!-- Theme initialization script to prevent FOUC -->
		<script is:inline>
			// Initialize theme before page renders to prevent flash
			(function () {
				const theme = localStorage.getItem('theme') || 'system';
				const root = document.documentElement;

				// Clean up any existing theme classes
				root.classList.remove('dark', 'light');

				if (theme === 'dark') {
					root.classList.add('dark');
				} else if (theme === 'light') {
					// Light mode - no additional classes needed
				} else {
					// system
					const systemPrefersDark = window.matchMedia(
						'(prefers-color-scheme: dark)'
					).matches;
					if (systemPrefersDark) {
						root.classList.add('dark');
					}
				}
			})();
		</script>
	</head>
	<body
		class='bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors'
	>
		<AppInsightsInit client:load />
		<Header />
		<main>
			<slot />
		</main>
		<Separator />
		<Footer client:load />
		<slot name='scripts' />
	</body>
</html>
